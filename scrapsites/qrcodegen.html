<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Enhanced QR Code Generator</title>
<style>
  :root {
    --bg: #0f1724;
    --card: #0b1220;
    --accent: #06b6d4;
    --muted: #94a3b8;
    --glass: rgba(255, 255, 255, 0.04);
  }
  html,body {
    height: 100%;
    margin: 0;
    font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
    color: #e6eef6;
    background: linear-gradient(180deg, #071126 0%, #061427 100%);
  }
  .wrap {max-width:980px;margin:32px auto;padding:20px;display:grid;grid-template-columns:1fr 420px;gap:20px}
  .card {
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius: 12px;
    padding: 18px;
    box-shadow: 0 6px 20px rgba(2,6,23,0.6);
  }
  h1 {margin:0 0 10px 0;font-size:20px}
  label {display:block;font-size:13px;color:var(--muted);margin-top:12px}
  input[type=text], select, input[type=number] {
    width:100%;padding:10px;margin-top:6px;border-radius:8px;
    border:1px solid rgba(255,255,255,0.04);background:transparent;color:inherit;
  }

  /* Modern color picker styling */
  .color-picker-wrapper {
    position: relative;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 8px;
  }
  input[type=color] {
    -webkit-appearance: none;
    border: 2px solid rgba(255,255,255,0.08);
    border-radius: 50%;
    width: 40px;
    height: 40px;
    padding: 0;
    background: none;
    cursor: pointer;
    transition: transform 0.2s, box-shadow 0.3s;
  }
  input[type=color]:hover {
    transform: scale(1.1);
    box-shadow: 0 0 0 4px rgba(255,255,255,0.05);
  }
  input[type=color]::-webkit-color-swatch {
    border: none;
    border-radius: 50%;
  }
  input[type=color]::-moz-color-swatch {
    border: none;
    border-radius: 50%;
  }

  .row {display:flex;gap:8px}
  .row > * {flex:1}
  button {
    background: var(--accent);
    border: none;
    padding: 10px 12px;
    border-radius: 8px;
    color: #032;
    cursor: pointer;
    font-weight: 600;
  }
  .muted {font-size:13px;color:var(--muted)}
  .preview {display:flex;flex-direction:column;align-items:center;justify-content:center;gap:10px}
  canvas {background:white;border-radius:8px}
  .actions {display:flex;gap:8px;margin-top:12px}
  .link-btn {
    background: transparent;
    border: 1px solid rgba(255,255,255,0.06);
    padding: 8px;
    border-radius: 8px;
    color: var(--muted);
    cursor: pointer;
  }
  footer {grid-column:1/-1;margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
  .logo-preview {max-width:20%;max-height:60px;border-radius:6px;object-fit:contain}
  @media (max-width:920px){.wrap{grid-template-columns:1fr;}}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>QR Code Generator</h1>
    <div class="muted">Customize size, colors, and add logos easily.</div>

    <label>Text / URL</label>
    <input id="text" type="text" placeholder="https://example.com" value="https://example.com">

    <div class="row">
      <div>
        <label>Size (px)</label>
        <input id="size" type="number" min="128" max="2048" value="512">
      </div>
      <div>
        <label>Error correction</label>
        <select id="ec">
          <option value="L">L — 7%</option>
          <option value="M" selected>M — 15%</option>
          <option value="Q">Q — 25%</option>
          <option value="H">H — 30%</option>
        </select>
      </div>
    </div>

    <div class="row">
      <div>
        <label>Foreground</label>
        <div class="color-picker-wrapper"><input id="fg" type="color" value="#000000"></div>
      </div>
      <div>
        <label>Background</label>
        <div class="color-picker-wrapper"><input id="bg" type="color" value="#ffffff"></div>
      </div>
    </div>

    <label>Embed logo</label>
    <input id="logoFile" type="file" accept="image/*">
    <div class="row" style="align-items:center;margin-top:8px">
      <div>
        <label>Logo scale (%)</label>
        <input id="logoSize" type="number" min="10" max="50" value="20">
      </div>
      <div><label>&nbsp;</label><button id="generate" class="small">Generate</button></div>
    </div>

    <div class="actions">
      <button id="downloadPng">Download PNG</button>
      <button id="downloadSvg" class="link-btn">Download SVG</button>
      <button id="copyData" class="link-btn">Copy text</button>
    </div>
  </div>

  <div class="card">
    <div class="preview">
      <div class="muted">Preview</div>
      <canvas id="qrCanvas" width="512" height="512" style="width:100%;max-width:420px;max-height:420px"></canvas>
      <img id="logoPreview" class="logo-preview" style="display:none" alt="logo preview">
    </div>
  </div>

  <footer class="card">✨ Sleek Dark UI — Offline & Open Source</footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/qrcode@1.5.1/build/qrcode.min.js"></script>
<script>
  const textEl=document.getElementById('text'),sizeEl=document.getElementById('size'),
        ecEl=document.getElementById('ec'),fgEl=document.getElementById('fg'),bgEl=document.getElementById('bg'),
        logoFileEl=document.getElementById('logoFile'),logoSizeEl=document.getElementById('logoSize'),
        canvas=document.getElementById('qrCanvas'),ctx=canvas.getContext('2d');
  let logoImage=null;

  logoFileEl.addEventListener('change',e=>{
    const f=e.target.files?.[0]; if(!f){logoImage=null;return;}
    const r=new FileReader(); r.onload=ev=>{
      const img=new Image(); img.onload=()=>logoImage=img; img.src=ev.target.result;
    }; r.readAsDataURL(f);
  });

  async function renderQR(){
    const value=textEl.value,size=Number(sizeEl.value),ec=ecEl.value,fg=fgEl.value,bg=bgEl.value;
    canvas.width=size; canvas.height=size;
    ctx.fillStyle=bg; ctx.fillRect(0,0,size,size);
    if(!value) return;
    const opts={errorCorrectionLevel:ec,margin:1,width:size,color:{dark:fg,light:bg}};
    const dataUrl=await QRCode.toDataURL(value,opts);
    const img=new Image(); await new Promise(r=>{img.onload=r;img.src=dataUrl});
    ctx.drawImage(img,0,0,size,size);
    if(logoImage){
      const s=Math.max(10,Math.min(50,Number(logoSizeEl.value)))/100;
      const w=size*s,h=size*s,x=(size-w)/2,y=(size-h)/2;
      ctx.drawImage(logoImage,x,y,w,h);
    }
  }
  document.getElementById('generate').addEventListener('click',renderQR);
  ['input','change'].forEach(ev=>[textEl,sizeEl,ecEl,fgEl,bgEl,logoSizeEl].forEach(el=>el.addEventListener(ev,()=>setTimeout(renderQR,300))));
  renderQR();
</script>
</body>
</html>
